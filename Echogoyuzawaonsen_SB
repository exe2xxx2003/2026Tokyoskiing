<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 é›ªã¨é­”æ³•ã®æ—…</title>
    <!-- Favicon as Emoji -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â„ï¸</text></svg>">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        /* å…¨å±€æ¨£å¼ */
        body {
            font-family: 'Zen Maru Gothic', 'Noto Sans TC', sans-serif;
            background-color: #fff5f7;
            overflow: hidden; 
            touch-action: manipulation;
        }

        /* æ«»èŠ±èˆ‡é›ªèŠ±èƒŒæ™¯ */
        .magic-bg {
            background-image: 
                radial-gradient(#e0f2fe 2px, transparent 2px),
                radial-gradient(#fbcfe8 2px, transparent 2px);
            background-size: 50px 50px;
            background-position: 0 0, 25px 25px;
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: -1;
            opacity: 0.6;
        }

        /* ç»ç’ƒæ“¬æ…‹å¡ç‰‡ */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.05);
        }

        /* æ²è»¸éš±è—ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* å¤©æ°£å‹•ç•« */
        .weather-pulse {
            animation: pulse-soft 2s infinite;
        }
        @keyframes pulse-soft {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- è³‡æ–™åº« ---
        const LOCATION_MAP = {
            '1/14 (ä¸‰)': { name: 'æ±äº¬ (ä¸Šé‡)', lat: 35.71, lon: 139.77, tenkiUrl: 'https://tenki.jp/forecast/3/16/4410/13106/' },
            '1/15 (å››)': { name: 'è¶Šå¾Œæ¹¯æ¾¤', lat: 36.93, lon: 138.81, tenkiUrl: 'https://tenki.jp/forecast/4/18/5420/15461/' },
            '1/16 (äº”)': { name: 'è¶Šå¾Œæ¹¯æ¾¤', lat: 36.93, lon: 138.81, tenkiUrl: 'https://tenki.jp/forecast/4/18/5420/15461/' },
            '1/17 (å…­)': { name: 'ç®±æ ¹', lat: 35.23, lon: 139.10, tenkiUrl: 'https://tenki.jp/forecast/3/17/4620/14382/' },
            '1/18 (æ—¥)': { name: 'æ±äº¬ (éº»å¸ƒå°)', lat: 35.65, lon: 139.74, tenkiUrl: 'https://tenki.jp/forecast/3/16/4410/13103/' }
        };

        // è¡Œç¨‹è³‡æ–™
        const initialItinerary = [
            // 1/14
            { id: '1-14-1', date: '1/14 (ä¸‰)', time: 'å…¨å¤©', title: 'æŠµé”æ±äº¬', detail: 'å…¥å¢ƒã€é ˜å– JR Passã€Skyliner é€²å¸‚å€ã€‚', type: 'transport', icon: 'fa-plane' },
            { id: '1-14-2', date: '1/14 (ä¸‰)', time: 'æ™šä¸Š', title: 'å…¥ä½ Smart Stay Shizuku', detail: 'ä¸Šé‡ç«™é™„è¿‘ã€‚', type: 'stay', icon: 'fa-bed', map: 'Smart Stay Shizuku Ueno' },
            
            // 1/15
            { id: '1-15-1', date: '1/15 (å››)', time: '06:14', title: 'æ–°å¹¹ç·šå‰å¾€è¶Šå¾Œæ¹¯æ²¢', detail: 'ä¸Šé‡å‡ºç™¼ (07:22 æŠµé”)ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-15-2', date: '1/15 (å››)', time: '08:00', title: 'ç§Ÿé›ªå…· (Boosport)', detail: 'å¯„æ”¾è¡Œæ (Â¥500)ã€‚', type: 'ski', icon: 'fa-snowflake', map: 'https://maps.app.goo.gl/ZgaCjXruQEKEET9X8' },
            { id: '1-15-3', date: '1/15 (å››)', time: '10:00', title: 'å²©åŸæ»‘é›ªå ´', detail: 'åˆå­¸è€…å¤©å ‚ã€‚', type: 'ski', icon: 'fa-person-skiing' },
            { id: '1-15-4', date: '1/15 (å››)', time: '17:00', title: 'å›é›ªå…·åº— & æ™šé¤', detail: 'æ­¸é‚„é›ªå…·æ‹¿è¡Œæã€‚æ™šé¤ï¼šäººåƒäº­è±¬æ’ (è¶Šå¾Œã¨ã‚“ã‹ã¤äººå‚äº­)ã€‚', type: 'food', icon: 'fa-utensils', map: 'Echigo Tonkatsu Ninjintei' },
            { id: '1-15-5', date: '1/15 (å››)', time: '20:30', title: 'å‰å¾€å¤©ä½¿æ ¼è˜­å¸äº', detail: 'æ­ä¹˜é£¯åº—æ¥é§è»Š (é è¨ˆæ­¤ç­æ¬¡)ã€‚', type: 'stay', icon: 'fa-bus', map: 'https://maps.app.goo.gl/oxyC98huDBDzySvX9' },

            // 1/16
            { id: '1-16-1', date: '1/16 (äº”)', time: '08:30', title: 'å‰å¾€è»Šç«™', detail: 'å¸¶è¡Œææ­é£¯åº—æ¥é§è»Šåˆ°è¶Šå¾Œæ¹¯æ¾¤è»Šç«™ã€‚', type: 'transport', icon: 'fa-bus' },
            { id: '1-16-2', date: '1/16 (äº”)', time: '09:00', title: 'å¯„æ”¾è¡Œæ & GALA', detail: 'è¡Œææ”¾é›ªå…·åº—ã€‚å‰å¾€ GALA æ»‘é›ªã€‚', type: 'ski', icon: 'fa-person-snowboarding' },
            { id: '1-16-3', date: '1/16 (äº”)', time: '16:00', title: 'æ­¸é‚„é›ªå…·', detail: 'Boosport é‚„è£å‚™ã€æ‹¿è¡Œæã€‚', type: 'ski', icon: 'fa-check', map: 'https://maps.app.goo.gl/ZgaCjXruQEKEET9X8' },
            { id: '1-16-4', date: '1/16 (äº”)', time: '17:41', title: 'æ–°å¹¹ç·šå›æ±äº¬', detail: 'è¶Šå¾Œæ¹¯æ²¢ -> å¤§å®® (è½‰ä¹˜ JR) -> æ–°å®¿ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-16-5', date: '1/16 (äº”)', time: '20:30', title: 'æ™šé¤ï¼šç‡’è‚‰', detail: 'è‚‰å±‹ã®å°æ‰€ æ–°å®¿ (å·²é ç´„ 12 äºº)ã€‚', type: 'food', icon: 'fa-utensils', map: 'https://maps.app.goo.gl/GEe34JNBwnoojuSKA' },
            { id: '1-16-6', date: '1/16 (äº”)', time: 'æ™šä¸Š', title: 'å…¥ä½æ–°å®¿', detail: 'Ny cottage B (è¥¿æ–°å®¿äº”ä¸ç›®)ã€‚', type: 'stay', icon: 'fa-house', map: 'Ny cottage B' },

            // 1/17 (ä¿®æ­£ï¼šæ–°å®¿->æ±äº¬->å°ç”°åŸ)
            { id: '1-17-1', date: '1/17 (å…­)', time: '08:41', title: 'å‰å¾€æ±äº¬ç«™', detail: 'æ–°å®¿ (JRä¸­å¤®ç·š) -> æ±äº¬ (08:54)ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-17-2', date: '1/17 (å…­)', time: '09:00', title: 'ç‰¹æ€¥è¸´å­1è™Ÿ', detail: 'æ±äº¬ -> å°ç”°åŸ (10:01)ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-17-3', date: '1/17 (å…­)', time: '10:20', title: 'ç®±æ ¹å·´å£« (U01)', detail: 'å°ç”°åŸ -> å…ƒç®±æ ¹ (11:12)ã€‚', type: 'transport', icon: 'fa-bus' },
            { id: '1-17-4', date: '1/17 (å…­)', time: '12:00', title: 'ç®±æ ¹ç¥ç¤¾', detail: 'æ°´ä¸Šé³¥å±…åƒæ‹œã€‚æ­¥è¡Œ 15 åˆ†é˜ã€‚', type: 'sightseeing', icon: 'fa-torii-gate', map: 'Hakone Shrine' },
            { id: '1-17-5', date: '1/17 (å…­)', time: '13:25', title: 'ç®±æ ¹æµ·è³Šèˆ¹', detail: 'å…ƒç®±æ ¹æ¸¯ -> æ¡ƒæºå°æ¸¯ (13:50)ã€‚', type: 'sightseeing', icon: 'fa-ship' },
            { id: '1-17-6', date: '1/17 (å…­)', time: '15:17', title: 'å·´å£«å›ç®±æ ¹æ¹¯æœ¬', detail: 'æ¡ƒæºå° -> ç®±æ ¹æ¹¯æœ¬ã€‚', type: 'transport', icon: 'fa-bus' },
            { id: '1-17-7', date: '1/17 (å…­)', time: '16:30', title: 'ç®±æ ¹æ¹¯æœ¬/å‰æ± æº«æ³‰', detail: 'è€è¡—é€›é€›ã€æ—¥æ­¸æº«æ³‰ã€‚', type: 'relax', icon: 'fa-hot-tub-person', map: 'Yoshiike Ryokan Hakone' },
            { id: '1-17-8', date: '1/17 (å…­)', time: '19:15', title: 'ç™»å±±é›»è»Š', detail: 'ç®±æ ¹æ¹¯æœ¬ -> å°ç”°åŸ (19:30)ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-17-9', date: '1/17 (å…­)', time: '19:42', title: 'JR å¿«é€Ÿé«˜å´', detail: 'å°ç”°åŸ -> æ–°å®¿ (21:08)ã€‚', type: 'transport', icon: 'fa-train' },
            { id: '1-17-10', date: '1/17 (å…­)', time: '21:30', title: 'å›æ°‘å®¿', detail: 'Ny cottage Bã€‚', type: 'stay', icon: 'fa-house', map: 'Ny cottage B' },

            // 1/18
            { id: '1-18-1', date: '1/18 (æ—¥)', time: '08:30', title: 'Team Lab éº»å¸ƒå°', detail: 'å…‰å½±å±•ã€‚', type: 'sightseeing', icon: 'fa-wand-magic-sparkles', map: 'teamLab Borderless: MORI Building DIGITAL ART MUSEUM' },
            { id: '1-18-2', date: '1/18 (æ—¥)', time: 'PM', title: 'å‰å¾€æˆç”°æ©Ÿå ´', detail: 'Skyliner / NEXã€‚', type: 'transport', icon: 'fa-plane-departure' }
        ];

        // äº¤é€šæ™‚åˆ»è¡¨è³‡æ–™
        const transportSchedule = {
            '1/14 (ä¸‰)': [
                { type: 'header', title: 'Skyliner å»ºè­°ç­æ¬¡ (æŠµé”+45åˆ†)' },
                { time: '13:39', dest: '14:24 ä¸Šé‡', note: 'å€«å€« (T1 12:35æŠµ)' },
                { time: '13:59', dest: '14:44 ä¸Šé‡', note: 'å€«å€«å‚™ç”¨' },
                { time: '15:59', dest: '16:44 ä¸Šé‡', note: 'East/HSuN (T1 14:55æŠµ)' },
                { time: '16:19', dest: '17:03 ä¸Šé‡', note: 'East/HSuN å‚™ç”¨' },
                { time: '17:19', dest: '18:04 ä¸Šé‡', note: 'å°æŸ¯/Aven/å¯¯å¯¬ (T1 16:15æŠµ)' },
                { time: '17:39', dest: '18:24 ä¸Šé‡', note: 'å°æŸ¯ç­‰ å‚™ç”¨' },
                { time: '19:38', dest: '20:25 ä¸Šé‡', note: 'Leo/å–„æ·³ (T1 18:40æŠµ)' },
                { time: '19:42', dest: '20:25 ä¸Šé‡', note: 'è¥¿ç“œ/æ³°å‹’/å²å¡”æ£® (T2 18:30æŠµ)' },
                { time: '20:00', dest: '20:46 ä¸Šé‡', note: 'Leo/å–„æ·³ å‚™ç”¨' },
                { time: '20:04', dest: '20:46 ä¸Šé‡', note: 'è¥¿ç“œ/æ³°å‹’/å²å¡”æ£® (T2) å‚™ç”¨' }
            ],
            '1/15 (å››)': [
                { type: 'header', title: 'ğŸš„ æ–°å¹¹ç·š (JR Pass)' },
                { time: '06:14', dest: '07:22 è¶Šå¾Œæ¹¯æ²¢', note: 'Toki 301 (ä¸Šé‡ç™¼)' },
                { type: 'header', title: 'ğŸšŒ é£¯åº—æ¥é§ (è¶Šå¾Œæ¹¯æ²¢ç«™æ±å£)' },
                { time: '16:00', dest: 'å¤©ä½¿æ ¼è˜­', note: 'æ±å£ç™¼' },
                { time: '16:30', dest: 'å¤©ä½¿æ ¼è˜­', note: '' },
                { time: '17:00', dest: 'å¤©ä½¿æ ¼è˜­', note: '' },
                { time: '17:30', dest: 'å¤©ä½¿æ ¼è˜­', note: '' },
                { time: '18:30', dest: 'å¤©ä½¿æ ¼è˜­', note: '' },
                { time: '19:30', dest: 'å¤©ä½¿æ ¼è˜­', note: '' },
                { time: '20:30', dest: 'å¤©ä½¿æ ¼è˜­', note: 'â˜…é è¨ˆæ­ä¹˜ (æœ«ç­21:30)' }
            ],
            '1/16 (äº”)': [
                { type: 'header', title: 'ğŸšŒ é£¯åº—æ¥é§ (å¤©ä½¿æ ¼è˜­ -> è¶Šå¾Œæ¹¯æ²¢ç«™)' },
                { time: '08:30', dest: 'è¶Šå¾Œæ¹¯æ²¢ç«™', note: 'é¦–ç­è»Š' },
                { time: '09:00', dest: 'è¶Šå¾Œæ¹¯æ²¢ç«™', note: '' },
                { time: '09:30', dest: 'è¶Šå¾Œæ¹¯æ²¢ç«™', note: '' },
                { type: 'header', title: 'ğŸš„ æ–°å¹¹ç·š (å›ç¨‹)' },
                { time: '17:41', dest: '18:35 å¤§å®®', note: 'Tanigawa 412 (è½‰ä¹˜é»)' },
                { type: 'header', title: 'ğŸšƒ å¤§å®®è½‰ä¹˜ (å¾€æ–°å®¿)' },
                { time: '18:46', dest: '19:19 æ–°å®¿', note: 'JR æ¹˜å—æ–°å®¿ç·š' },
                { time: '18:50', dest: '19:21 æ–°å®¿', note: 'JR åŸ¼äº¬ç·š (å‚™ç”¨)' }
            ],
            '1/17 (å…­)': [
                { type: 'header', title: 'ğŸš‡ å»ç¨‹ (æ–°å®¿ -> æ±äº¬ -> ç®±æ ¹)' },
                { time: '08:41', dest: '08:54 æ±äº¬', note: 'JRä¸­å¤®ç·š (æ–°å®¿ç™¼)' },
                { time: '09:00', dest: '10:01 å°ç”°åŸ', note: 'ç‰¹æ€¥è¸´å­1è™Ÿ (æ±äº¬ç™¼)' },
                { time: '10:20', dest: '11:12 å…ƒç®±æ ¹', note: 'ç®±æ ¹å·´å£« U01' },
                { type: 'header', title: 'ğŸš¢ éŠè¦½' },
                { time: '13:25', dest: '13:50 æ¡ƒæºå°', note: 'æµ·è³Šèˆ¹' },
                { time: '15:17', dest: 'ç®±æ ¹æ¹¯æœ¬', note: 'å·´å£«' },
                { type: 'header', title: 'ğŸš‡ å›ç¨‹ (ç®±æ ¹ -> æ–°å®¿)' },
                { time: '19:15', dest: '19:30 å°ç”°åŸ', note: 'ç®±æ ¹ç™»å±±ç·š' },
                { time: '19:42', dest: '21:08 æ–°å®¿', note: 'JR å¿«é€Ÿé«˜å´' }
            ],
            '1/18 (æ—¥)': [
                 { type: 'header', title: 'âœˆï¸ å›ç¨‹èˆªç­' },
                 { time: '14:35', dest: 'CI101', note: 'æˆç”° T2 (æ³°å‹’/å²å¡”æ£®)' },
                 { time: '15:40', dest: 'JX803', note: 'æˆç”° T2 (å€«å€«)' },
                 { time: '16:35', dest: 'MM625', note: 'æˆç”° T1 (East/HSuN)' },
                 { time: '17:15', dest: 'SL395', note: 'æˆç”° T1 (å°æŸ¯/Aven/å¯¯å¯¬)' },
                 { time: '17:45', dest: 'CI105', note: 'æˆç”° T2 (è¥¿ç“œ)' },
                 { time: '17:15', dest: 'SL395', note: 'æˆç”° T1 (Leo/å–„æ·³)' }
            ]
        };

        const gearData = [
            { name: "HUANG YENLIN", item: "Ski å…¨å¥—", h: "176", f: "27.5", type: "ski" },
            { name: "CHANG, KAI PO", item: "SB (å·¦å‰)", h: "165", f: "26.5", type: "sb" },
            { name: "LIN, CHENG LUN", item: "SB Burton (å·¦å‰)", h: "172", f: "28", type: "sb" },
            { name: "Shih-Che Chen", item: "SB Burton (å³å‰)", h: "175", f: "27.5", type: "sb" },
            { name: "Ko chechin", item: "Ski å…¨å¥—", h: "170", f: "27.5", type: "ski" },
            { name: "HUANG YUNG PI", item: "Ski å¥—è£", h: "175", f: "27", type: "ski" },
            { name: "Cheng tung yao", item: "SB å…¨å¥— (å·¦å‰)", h: "180", f: "27", type: "sb" },
            { name: "LIU CHANG LIN", item: "Ski å…¨å¥—", h: "183", f: "28.5", type: "ski" },
            { name: "ZHANG, EN-MAO", item: "Ski å…¨å¥—", h: "172", f: "27", type: "ski" },
            { name: "CHUN KUAN HUANG", item: "Ski å…¨å¥—", h: "174", f: "27", type: "ski" },
            { name: "CHEN, KUAN-CHUN", item: "SB å…¨å¥— (å·¦å‰)", h: "168", f: "26.5", type: "sb" },
            { name: "YANG SHAN CHUN", item: "SB Burton (å·¦å‰)", h: "170", f: "28", type: "sb" }
        ];

        // èˆªç­è³‡æ–™ (é¡¯ç¤ºå®Œæ•´æ™‚é–“)
        const flightData = [
            { name: "å€«å€«", out: "JX800 (08:25 ~ 12:35)", in: "JX803 (15:40 ~ 18:45)", timeVal: 825 },
            { name: "East", out: "MM626 (10:40 ~ 14:55)", in: "MM625 (16:35 ~ 20:00)", timeVal: 1040 },
            { name: "HSuN", out: "MM626 (10:40 ~ 14:55)", in: "MM625 (16:35 ~ 20:00)", timeVal: 1040 },
            { name: "å°æŸ¯", out: "SL394 (12:10 ~ 16:15)", in: "SL395 (17:15 ~ 20:20)", timeVal: 1210 },
            { name: "Aven", out: "SL394 (12:10 ~ 16:15)", in: "SL395 (17:15 ~ 20:20)", timeVal: 1210 },
            { name: "å¯¯å¯¬", out: "SL394 (12:10 ~ 16:15)", in: "SL395 (17:15 ~ 20:20)", timeVal: 1210 },
            { name: "è¥¿ç“œ", out: "CI108 (14:25 ~ 18:30)", in: "CI105 (17:45 ~ 20:55)", timeVal: 1425 },
            { name: "æ³°å‹’", out: "CI108 (14:25 ~ 18:30)", in: "CI101 (14:35 ~ 17:45)", timeVal: 1425 },
            { name: "å²å¡”æ£®", out: "CI108 (14:25 ~ 18:30)", in: "CI101 (14:35 ~ 17:45)", timeVal: 1425 },
            { name: "Leo", out: "TR874 (14:40 ~ 18:40)", in: "SL395 (17:15 ~ 20:20)", timeVal: 1440 },
            { name: "å–„æ·³", out: "TR874 (14:40 ~ 18:40)", in: "SL395 (17:15 ~ 20:20)", timeVal: 1440 }
        ].sort((a, b) => a.timeVal - b.timeVal);

        // --- å…ƒä»¶ï¼šå¤©æ°£å°å¡ ---
        const WeatherWidget = ({ date }) => {
            const [weather, setWeather] = useState(null);
            const [loading, setLoading] = useState(false);
            const location = LOCATION_MAP[date];

            useEffect(() => {
                if (!location) return;
                const fetchWeather = async () => {
                    setLoading(true);
                    try {
                        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${location.lat}&longitude=${location.lon}&current_weather=true&timezone=Asia%2FTokyo`);
                        const data = await res.json();
                        setWeather(data.current_weather);
                    } catch (error) { console.error(error); } finally { setLoading(false); }
                };
                fetchWeather();
            }, [date]);

            const getWeatherIcon = (code) => {
                if (code === 0) return { icon: 'fa-sun', color: 'text-orange-400', label: 'æ™´' };
                if (code <= 3) return { icon: 'fa-cloud-sun', color: 'text-gray-400', label: 'å¤šé›²' };
                if (code <= 77) return { icon: 'fa-snowflake', color: 'text-blue-300', label: 'é›ª' }; 
                if (code <= 86) return { icon: 'fa-snowflake', color: 'text-blue-300', label: 'å¤§é›ª' };
                return { icon: 'fa-cloud-rain', color: 'text-blue-400', label: 'é›¨' };
            };

            if (!location) return null;
            return (
                <a href={location.tenkiUrl} target="_blank" className="block mx-4 mb-4 bg-gradient-to-r from-blue-50 to-pink-50 rounded-xl p-3 border border-white relative overflow-hidden shadow-sm active:scale-95 transition-transform">
                    <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3">
                            <div className="bg-white w-10 h-10 rounded-full flex items-center justify-center shadow-sm">
                                {loading ? <i className="fa-solid fa-circle-notch fa-spin text-gray-300"></i> : weather ? <i className={`fa-solid ${getWeatherIcon(weather.weathercode).icon} ${getWeatherIcon(weather.weathercode).color} text-xl weather-pulse`}></i> : <i className="fa-solid fa-cloud text-gray-300"></i>}
                            </div>
                            <div>
                                <div className="text-xs font-bold text-gray-500 flex items-center"><i className="fa-solid fa-location-dot mr-1 text-[10px]"></i>{location.name}</div>
                                <div className="text-sm font-bold text-gray-700">{loading ? "..." : weather ? `${weather.temperature}Â°C` : "--"}</div>
                            </div>
                        </div>
                        <div className="text-xs text-blue-400 font-bold bg-white/60 px-2 py-1 rounded-lg">Tenki.jp <i className="fa-solid fa-arrow-up-right-from-square ml-1"></i></div>
                    </div>
                </a>
            );
        };

        // --- å…ƒä»¶ï¼šå°èˆªæŒ‰éˆ• ---
        const MapLink = ({ query, label = "å°èˆª" }) => (
            <a href={query.startsWith('http') ? query : `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`} target="_blank" 
               className="inline-flex items-center gap-1 bg-blue-50 text-blue-500 px-2 py-1 rounded-md text-xs font-bold hover:bg-blue-100 ml-2 shadow-sm border border-blue-100"
               onClick={e => e.stopPropagation()}>
                <i className="fa-solid fa-location-arrow"></i> {label}
            </a>
        );

        // --- å…ƒä»¶ï¼šè¡Œç¨‹é é¢ ---
        const ItineraryPage = ({ items, setItems, isEditing }) => {
            const [selectedDate, setSelectedDate] = useState('1/15 (å››)');
            const [newItem, setNewItem] = useState({ time: '', title: '', detail: '', type: 'ski' });
            const allDates = ['1/14 (ä¸‰)', '1/15 (å››)', '1/16 (äº”)', '1/17 (å…­)', '1/18 (æ—¥)'];
            const currentItems = items.filter(item => item.date === selectedDate);

            const addItem = () => {
                if(!newItem.title) return;
                setItems([...items, { ...newItem, date: selectedDate, id: Date.now(), icon: 'fa-star' }].sort((a,b) => a.date.localeCompare(b.date) || a.time.localeCompare(b.time)));
                setNewItem({ time: '', title: '', detail: '', type: 'ski' });
            };

            return (
                <div className="h-full flex flex-col pt-2">
                    <div className="px-2 py-2 overflow-x-auto no-scrollbar flex space-x-2 sticky top-0 z-20">
                        {allDates.map(date => (
                            <button key={date} onClick={() => setSelectedDate(date)} className={`flex-shrink-0 flex flex-col items-center justify-center w-14 h-14 rounded-2xl transition-all border-2 ${selectedDate === date ? 'bg-pink-400 border-pink-400 text-white shadow-lg scale-105' : 'bg-white/60 border-white text-gray-400'}`}>
                                <span className="text-xs opacity-80">{date.split(' ')[1].replace(/[()]/g, '')}</span>
                                <span className="text-lg font-bold leading-none">{date.split(' ')[0].split('/')[1]}</span>
                            </button>
                        ))}
                    </div>

                    <div className="flex-1 overflow-y-auto no-scrollbar pb-24 pt-2">
                        <WeatherWidget date={selectedDate} />
                        <div className="px-4 space-y-4">
                            {currentItems.map(item => (
                                <div key={item.id} className="glass-card p-4 rounded-xl relative border-l-4 border-l-pink-300">
                                    {isEditing && <button onClick={() => setItems(items.filter(i => i.id !== item.id))} className="absolute top-2 right-2 text-red-400"><i className="fa-solid fa-trash"></i></button>}
                                    <div className="flex gap-4">
                                        <div className="flex flex-col items-center min-w-[3.5rem] pt-1 border-r border-dashed border-gray-200 pr-3">
                                            <span className="text-sm font-bold text-gray-600 font-mono bg-pink-50 px-2 rounded">{item.time}</span>
                                            <div className="mt-3 text-2xl text-pink-300 opacity-80"><i cl
