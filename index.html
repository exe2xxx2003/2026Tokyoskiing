<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 Japan Snow Trip</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>window.react = window.React;</script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>

    <style>
        /* 日式極簡字體與配色優化 */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f5f5f4;
            color: #44403c;
            -webkit-tap-highlight-color: transparent;
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .nav-glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid #e7e5e4;
        }

        .card-shadow {
            box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.05);
        }

        .japan-blue {
            color: #1e3a8a;
        }

        .japan-red {
            color: #be123c;
        }

        .tag-food {
            background-color: #fef3c7;
            color: #92400e;
        }

        .tag-buy {
            background-color: #dcfce7;
            color: #166534;
        }

        .tag-tip {
            background-color: #e0e7ff;
            color: #3730a3;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { MapPin, Calendar, Coffee, Train, Hotel, Phone, Plane, Snowflake, CreditCard, ChevronRight, Info, Utensils, ShoppingBag, AlertCircle } = LucideReact;

        // --- 核心資料 (整合自你提供的 CSV) ---
        const tripData = {
            itinerary: [
                {
                    date: "1/14 (三)",
                    title: "抵達與移動日",
                    weather: "晴時多雲 8°C",
                    location: "東京上野",
                    events: [
                        { time: "Day", type: "transport", title: "抵達東京", desc: "成田機場 -> 上野 (Skyliner)", cost: "¥2,570", nav: "Keisei Ueno Station" },
                        { time: "Task", type: "task", title: "購買 JR 東京廣域周遊券", desc: "上野站 JR 服務中心購買 (¥15,000/人)", isImportant: true, nav: "JR Ueno Station" },
                        { time: "Stay", type: "hotel", title: "Smart Stay Shizuku Ueno", desc: "膠囊旅館體驗", nav: "Smart Stay Shizuku Ueno" }
                    ]
                },
                {
                    date: "1/15 (四)",
                    title: "岩原滑雪場",
                    weather: "大雪 -2°C",
                    location: "越後湯澤",
                    events: [
                        { time: "06:14", type: "transport", title: "新幹線前往越後湯澤", desc: "上野發 (谷川 471) -> 07:22 抵達", cost: "周遊券 Cover" },
                        { time: "07:40", type: "snow", title: "租雪具 (Boosport)", desc: "行李寄放於雪具店 (¥500)", nav: "Boosport Yuzawa" },
                        {
                            time: "09:00", type: "snow", title: "岩原滑雪場 (Iwappara)", desc: "初學者天堂，寬闊雪道", nav: "Iwappara Ski Resort",
                            guide: { food: "必吃：雪場中段 Pizzeria La Locanda del Pittore (超有名披薩)", tips: "記得在入口處開通電子雪票" }
                        },
                        { time: "18:00", type: "food", title: "越後湯澤晚餐", desc: "車站周邊", guide: { food: "推薦：爆彈飯糰、清酒博物館 (Ponshukan)" } },
                        { time: "Night", type: "hotel", title: "天使格蘭帝亞酒店", desc: "有接駁車，適合團體", nav: "Hotel Angel Grandia Echigo-Nakazato" }
                    ]
                },
                {
                    date: "1/16 (五)",
                    title: "GALA 湯澤滑雪 & 移動",
                    weather: "小雪 -1°C",
                    location: "越後湯澤 -> 新宿",
                    events: [
                        { time: "Morning", type: "task", title: "行李寄放", desc: "帶回雪具店寄放 ¥500", nav: "Boosport Yuzawa" },
                        {
                            time: "10:00", type: "snow", title: "GALA 湯澤滑雪場", desc: "新幹線直達，交通方便", nav: "GALA Yuzawa Snow Resort",
                            guide: { food: "GALA 美食街擁擠，建議提早用餐", tips: "下山時可搭乘纜車看風景" }
                        },
                        { time: "17:41", type: "transport", title: "新幹線回東京", desc: "越後湯澤 -> 大宮 -> 新宿 (19:21抵達)", cost: "周遊券 Cover" },
                        { time: "19:40", type: "hotel", title: "西新宿民宿", desc: "103 3-minute walk to Nishi-Shinjuku 5-chome", nav: "Nishi-Shinjuku 5-chome Station" },
                        { time: "Dinner", type: "food", title: "新宿晚餐", desc: "西新宿周邊", guide: { food: "燒肉 Like, 居酒屋街" } }
                    ]
                },
                {
                    date: "1/17 (六)",
                    title: "箱根一日遊",
                    weather: "多雲 5°C",
                    location: "箱根",
                    events: [
                        { time: "08:48", type: "transport", title: "前往新宿車站", desc: "大江戶線", cost: "¥178" },
                        { time: "09:25", type: "transport", title: "特急踴子號 -> 小田原", desc: "JR 廣域券 Cover", nav: "Odawara Station" },
                        { time: "10:45", type: "transport", title: "前往元箱根港", desc: "箱根登山巴士 (Z03/H線)", nav: "Moto-Hakone Port" },
                        {
                            time: "12:00", type: "sight", title: "箱根神社 & 鳥居", desc: "步行 15 分鐘", nav: "Hakone Shrine",
                            guide: { food: "必吃：Hakone Cheese Terrace, 鰻魚飯, 蕎麥麵", buy: "雲助糰子", tips: "海上鳥居拍照需排隊約 30-40 分鐘" }
                        },
                        { time: "13:25", type: "sight", title: "海賊船遊蘆之湖", desc: "元箱根港 -> 桃源台港", cost: "¥1,200", nav: "Togendai Port" },
                        { time: "16:30", type: "sight", title: "箱根湯本老街", desc: "特色：黑色溫泉蛋、熱饅頭", nav: "Hakone Yumoto Shopping Street" },
                        { time: "16:30", type: "spa", title: "吉池溫泉 (日歸)", desc: "¥2,250 + 毛巾 ¥330", nav: "Yoshiike Ryokan", guide: { tips: "知名的日式庭園，泡完湯必逛" } },
                        { time: "19:42", type: "transport", title: "回程：小田原 -> 新宿", desc: "JR 湘南新宿線", cost: "周遊券 Cover" }
                    ]
                },
                {
                    date: "1/18 (日)",
                    title: "市區觀光 & 返程",
                    weather: "晴天 9°C",
                    location: "東京",
                    events: [
                        { time: "08:30", type: "sight", title: "麻布台 Hills TeamLab", desc: "全新熱門景點", nav: "Azabudai Hills", guide: { tips: "預約制，請確認票券 QR Code" } },
                        { time: "12:40", type: "transport", title: "前往機場", desc: "倫倫先出發 (JX800 12:35 起飛需注意時間)", isImportant: true },
                        { time: "Check", type: "task", title: "檢查護照與隨身物品", desc: "確認所有成員航班時間" }
                    ]
                }
            ],
            flights: [
                { name: "倫倫", out: "JX800 08:25-12:35", in: "JX803 15:40-18:45" },
                { name: "east, HSuN", out: "MM626 10:40-14:55", in: "MM625 16:35-20:00" },
                { name: "小柯, aven, 寬, Leo, 善淳", out: "SL394 12:10-16:15", in: "SL395 17:15-20:20" },
                { name: "西瓜, 泰勒, 史塔森", out: "CI108 14:25-18:30", in: "CI105/CI101" }
            ],
            hotels: [
                { date: "1/14", name: "Smart Stay Shizuku Ueno", note: "east跟冠勲睡大宮" },
                { date: "1/15", name: "Hotel Angel Grandia Echigo-Nakazato", note: "越後中里，有接駁車" },
                { date: "1/16-18", name: "西新宿民宿 (Nishi-Shinjuku)", note: "5張雙人床 + 3張日式床鋪" }
            ],
            rentals: [
                { name: "HUANG YENLIN", item: "Ski 全套 (176/27.5)" },
                { name: "CHANG, KAI PO", item: "SB 單板 (165/26.5) Reg" },
                { name: "LIN, CHENG LUN", item: "SB Burton (172/28) Reg" },
                { name: "Shih-Che Chen", item: "SB Burton (175/27.5) Goofy" },
                { name: "Ko chechin", item: "Ski 全套 (170/27.5)" },
                { name: "更多...", item: "請查看完整 Excel" }
            ]
        };

        // --- 元件 Components ---

        const WeatherBadge = ({ weather }) => (
            <div className="flex items-center gap-1 text-xs font-medium bg-white/80 backdrop-blur px-2 py-1 rounded-full shadow-sm text-slate-600">
                {weather.includes("雪") ? <Snowflake size={12} className="text-blue-400" /> : <img src="https://openweathermap.org/img/wn/01d.png" className="w-4 h-4" alt="sun" />}
                {weather}
            </div>
        );

        const GuideTag = ({ type, text }) => {
            let colorClass = "";
            let Icon = null;
            if (type === "food") { colorClass = "tag-food"; Icon = Utensils; }
            if (type === "buy") { colorClass = "tag-buy"; Icon = ShoppingBag; }
            if (type === "tips") { colorClass = "tag-tip"; Icon = Info; }

            return (
                <div className={`mt-2 flex items-start gap-2 text-xs p-2 rounded-lg ${colorClass}`}>
                    <Icon size={14} className="mt-0.5 shrink-0" />
                    <span>{text}</span>
                </div>
            );
        };

        const EventCard = ({ event }) => {
            const getIcon = (type) => {
                switch (type) {
                    case 'transport': return <Train size={18} className="text-blue-600" />;
                    case 'food': return <Utensils size={18} className="text-orange-500" />;
                    case 'hotel': return <Hotel size={18} className="text-indigo-600" />;
                    case 'snow': return <Snowflake size={18} className="text-cyan-500" />;
                    case 'sight': return <MapPin size={18} className="text-red-500" />;
                    case 'task': return <CreditCard size={18} className="text-emerald-600" />;
                    default: return <Info size={18} className="text-gray-500" />;
                }
            };

            const openNav = () => {
                if (event.nav) {
                    window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.nav)}`, '_blank');
                }
            };

            return (
                <div className="bg-white p-4 rounded-xl card-shadow mb-3 relative overflow-hidden group transition-transform active:scale-[0.99]">
                    {event.isImportant && <div className="absolute top-0 left-0 w-1 h-full bg-red-500"></div>}
                    <div className="flex gap-4">
                        <div className="flex flex-col items-center gap-1 min-w-[50px]">
                            <span className="text-sm font-bold text-slate-800">{event.time}</span>
                            <div className="p-2 bg-slate-50 rounded-full">{getIcon(event.type)}</div>
                        </div>
                        <div className="flex-1">
                            <h3 className="font-bold text-slate-800 text-[15px]">{event.title}</h3>
                            <p className="text-sm text-slate-500 mt-1">{event.desc}</p>
                            {event.cost && <span className="inline-block mt-1 text-xs font-mono bg-slate-100 px-1.5 py-0.5 rounded text-slate-600">{event.cost}</span>}

                            {/* AI Guide Section */}
                            {event.guide && (
                                <div className="mt-2 space-y-1">
                                    {event.guide.food && <GuideTag type="food" text={event.guide.food} />}
                                    {event.guide.buy && <GuideTag type="buy" text={event.guide.buy} />}
                                    {event.guide.tips && <GuideTag type="tips" text={event.guide.tips} />}
                                </div>
                            )}
                        </div>
                    </div>
                    {event.nav && (
                        <button onClick={openNav} className="absolute top-4 right-4 text-slate-300 hover:text-blue-500 p-2">
                            <MapPin size={20} />
                        </button>
                    )}
                </div>
            );
        };

        const ItineraryTab = () => {
            const [activeDay, setActiveDay] = useState(0);

            return (
                <div className="pb-24">
                    {/* Header with Date Tabs */}
                    <div className="sticky top-0 z-10 bg-[#f5f5f4]/95 backdrop-blur pt-4 pb-2 px-2 overflow-x-auto hide-scrollbar flex gap-3 shadow-sm">
                        {tripData.itinerary.map((day, idx) => (
                            <button
                                key={idx}
                                onClick={() => setActiveDay(idx)}
                                className={`flex flex-col items-center min-w-[70px] p-2 rounded-xl transition-all ${activeDay === idx ? 'bg-slate-800 text-white shadow-lg scale-105' : 'bg-white text-slate-400'}`}
                            >
                                <span className="text-xs font-medium">{day.date.split(' ')[0]}</span>
                                <span className="text-sm font-bold">{day.date.split(' ')[1]}</span>
                            </button>
                        ))}
                    </div>

                    {/* Content */}
                    <div className="px-4 mt-4 animate-fade-in">
                        <div className="flex justify-between items-end mb-4 px-1">
                            <div>
                                <h1 className="text-2xl font-bold text-slate-800">{tripData.itinerary[activeDay].title}</h1>
                                <p className="text-slate-500 flex items-center gap-1 mt-1 text-sm">
                                    <MapPin size={14} /> {tripData.itinerary[activeDay].location}
                                </p>
                            </div>
                            <WeatherBadge weather={tripData.itinerary[activeDay].weather} />
                        </div>

                        <div>
                            {tripData.itinerary[activeDay].events.map((event, idx) => (
                                <EventCard key={idx} event={event} />
                            ))}
                        </div>

                        {/* Daily Summary / Nav Button */}
                        <div className="mt-6 p-4 bg-slate-200 rounded-xl text-center">
                            <p className="text-xs text-slate-500 mb-2">想查看當地天氣或路況？</p>
                            <button onClick={() => window.open(`https://www.google.com/maps/search/${tripData.itinerary[activeDay].location}`, '_blank')}
                                className="bg-white text-slate-800 px-6 py-2 rounded-full text-sm font-bold shadow-sm inline-flex items-center gap-2">
                                <MapPin size={16} /> 開啟 Google Maps
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const ToolsTab = () => {
            return (
                <div className="px-4 py-6 pb-24">
                    <h2 className="text-2xl font-bold text-slate-800 mb-6">旅程助手</h2>

                    {/* Flights */}
                    <div className="bg-white rounded-xl p-5 card-shadow mb-4">
                        <div className="flex items-center gap-2 mb-4 text-blue-800">
                            <Plane size={20} />
                            <h3 className="font-bold">航班資訊</h3>
                        </div>
                        <div className="space-y-4">
                            {tripData.flights.map((group, idx) => (
                                <div key={idx} className="border-b border-slate-100 last:border-0 pb-3 last:pb-0">
                                    <p className="text-sm font-bold text-slate-800 mb-1">{group.name}</p>
                                    <div className="grid grid-cols-2 gap-2 text-xs text-slate-500">
                                        <div>去: {group.out}</div>
                                        <div>回: {group.in}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Hotels */}
                    <div className="bg-white rounded-xl p-5 card-shadow mb-4">
                        <div className="flex items-center gap-2 mb-4 text-indigo-800">
                            <Hotel size={20} />
                            <h3 className="font-bold">住宿資訊</h3>
                        </div>
                        {tripData.hotels.map((h, idx) => (
                            <div key={idx} className="mb-3 text-sm">
                                <span className="font-bold text-indigo-600 block">{h.date}</span>
                                <div className="text-slate-800 font-medium">{h.name}</div>
                                <div className="text-slate-400 text-xs">{h.note}</div>
                            </div>
                        ))}
                    </div>

                    {/* Rentals */}
                    <div className="bg-white rounded-xl p-5 card-shadow mb-4">
                        <div className="flex items-center gap-2 mb-4 text-cyan-700">
                            <Snowflake size={20} />
                            <h3 className="font-bold">雪具租借 (Boosport)</h3>
                        </div>
                        <div className="max-h-40 overflow-y-auto pr-2">
                            {tripData.rentals.map((r, idx) => (
                                <div key={idx} className="flex justify-between text-xs py-2 border-b border-slate-50">
                                    <span className="font-medium text-slate-700">{r.name.split(' ')[0]}</span>
                                    <span className="text-slate-500 text-right">{r.item}</span>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Emergency & Links */}
                    <div className="grid grid-cols-2 gap-4">
                        <button className="bg-red-50 p-4 rounded-xl flex flex-col items-center justify-center gap-2 text-red-700 active:bg-red-100">
                            <Phone size={24} />
                            <span className="text-sm font-bold">緊急聯絡 (119)</span>
                        </button>
                        <button className="bg-green-50 p-4 rounded-xl flex flex-col items-center justify-center gap-2 text-green-700 active:bg-green-100">
                            <CreditCard size={24} />
                            <span className="text-sm font-bold">記帳表</span>
                        </button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('itinerary');

            return (
                <div className="min-h-screen bg-[#f5f5f4] max-w-md mx-auto relative shadow-2xl">
                    {activeTab === 'itinerary' ? <ItineraryTab /> : <ToolsTab />}

                    {/* Bottom Navigation */}
                    <div className="fixed bottom-0 left-0 w-full md:w-full md:max-w-md md:left-1/2 md:-translate-x-1/2 nav-glass pb-safe pt-2 px-6 flex justify-between items-center z-50 h-20">
                        <button
                            onClick={() => setActiveTab('itinerary')}
                            className={`flex flex-col items-center gap-1 transition-colors ${activeTab === 'itinerary' ? 'text-slate-800' : 'text-slate-400'}`}
                        >
                            <Calendar size={24} strokeWidth={activeTab === 'itinerary' ? 2.5 : 2} />
                            <span className="text-[10px] font-medium">行程</span>
                        </button>

                        <div className="w-12 h-12 bg-slate-800 rounded-full flex items-center justify-center text-white shadow-lg -mt-8 border-4 border-[#f5f5f4]">
                            <img src="https://flagcdn.com/jp.svg" className="w-6 h-6 rounded-full object-cover" alt="Japan" />
                        </div>

                        <button
                            onClick={() => setActiveTab('tools')}
                            className={`flex flex-col items-center gap-1 transition-colors ${activeTab === 'tools' ? 'text-slate-800' : 'text-slate-400'}`}
                        >
                            <Info size={24} strokeWidth={activeTab === 'tools' ? 2.5 : 2} />
                            <span className="text-[10px] font-medium">資訊</span>
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>